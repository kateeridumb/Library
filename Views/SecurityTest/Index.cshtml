<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞—â–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #4CAF50;
            padding-bottom: 10px;
        }
        h2 {
            color: #555;
            margin-top: 0;
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        button:hover {
            background: #45a049;
        }
        button.danger {
            background: #f44336;
        }
        button.danger:hover {
            background: #da190b;
        }
        .results {
            margin-top: 15px;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 5px;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }
        .success {
            color: #4CAF50;
        }
        .error {
            color: #f44336;
        }
        .warning {
            color: #ff9800;
        }
        input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            width: 300px;
            margin: 5px;
        }
        .header-test {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        .header-item {
            padding: 8px;
            background: #e8f5e9;
            border-left: 3px solid #4CAF50;
            margin: 5px 0;
        }
        .header-item.missing {
            background: #ffebee;
            border-left-color: #f44336;
        }
    </style>
</head>
<body>
    <h1>üîí –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞—â–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</h1>
    
    <div class="test-section" style="background: #d4edda; border-left: 4px solid #28a745;">
        <h2>‚úÖ –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é</h2>
        <p>–≠—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ —Å —Å–µ—Ä–≤–µ—Ä–∞, –ø–æ—ç—Ç–æ–º—É –ø—Ä–æ–±–ª–µ–º—ã —Å CORS –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç.</p>
        <p><strong>–¢–µ–∫—É—â–∏–π URL:</strong> <code id="currentUrl" style="background: #f8f9fa; padding: 5px; border-radius: 3px; font-size: 14px;"></code></p>
        <p style="color: green; font-weight: bold;">‚úì –í—Å–µ —Ç–µ—Å—Ç—ã –¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ</p>
    </div>
    
    <div class="test-section">
        <h2>1. –¢–µ—Å—Ç Rate Limiting (DDoS –∑–∞—â–∏—Ç–∞)</h2>
        <p>–û—Ç–ø—Ä–∞–≤–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏</p>
        <button onclick="testRateLimit()">–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç (15 –∑–∞–ø—Ä–æ—Å–æ–≤)</button>
        <button class="danger" onclick="testRateLimitAggressive()">–ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π —Ç–µ—Å—Ç (30 –∑–∞–ø—Ä–æ—Å–æ–≤)</button>
        <div id="rateLimitResults" class="results"></div>
    </div>

    <div class="test-section">
        <h2>2. –¢–µ—Å—Ç Security Headers</h2>
        <p>–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</p>
        <input type="text" id="testUrl" placeholder="/Home/Index" value="/Home/Index">
        <button onclick="testSecurityHeaders()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏</button>
        <div id="headersResults" class="results"></div>
    </div>

    <div class="test-section">
        <h2>3. –¢–µ—Å—Ç SQL Injection –∑–∞—â–∏—Ç–∞</h2>
        <p>–ü–æ–ø—ã—Ç–∫–∞ SQL –∏–Ω—ä–µ–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è</p>
        <input type="text" id="sqlTestEmail" placeholder="admin' OR '1'='1" value="admin' OR '1'='1">
        <button onclick="testSqlInjection()">–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å SQL –∏–Ω—ä–µ–∫—Ü–∏—é</button>
        <div id="sqlResults" class="results"></div>
    </div>

    <div class="test-section">
        <h2>4. –¢–µ—Å—Ç XSS –∑–∞—â–∏—Ç–∞ (CSP)</h2>
        <p>–ü–æ–ø—ã—Ç–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤–Ω–µ—à–Ω–µ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞</p>
        <button onclick="testXSS()">–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å XSS –∑–∞—â–∏—Ç—É</button>
        <div id="xssResults" class="results"></div>
    </div>

    <div class="test-section">
        <h2>5. –¢–µ—Å—Ç Clickjacking –∑–∞—â–∏—Ç–∞</h2>
        <p>–ü–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ iframe</p>
        <button onclick="testClickjacking()">–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å Clickjacking</button>
        <div id="clickjackingResults" class="results"></div>
    </div>

    <script>
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –±–∞–∑–æ–≤—ã–π URL –∏–∑ —Ç–µ–∫—É—â–µ–≥–æ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è
        let baseUrl = window.location.origin; // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ–∫—É—â–∏–π –¥–æ–º–µ–Ω –∏ –ø–æ—Ä—Ç
        
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ URL
        async function checkUrl(url) {
            try {
                const response = await fetch(url, { method: 'HEAD', mode: 'no-cors' });
                return true;
            } catch {
                return false;
            }
        }
        
        // –ü–æ–ø—ã—Ç–∫–∞ –Ω–∞–π—Ç–∏ —Ä–∞–±–æ—Ç–∞—é—â–∏–π –ø–æ—Ä—Ç
        async function detectPort() {
            const ports = [5155, 5000, 7107, 57620, 5001];
            const statusDiv = document.getElementById('connectionStatus');
            if (statusDiv) {
                statusDiv.innerHTML = '<p style="color: orange;">üîç –ü–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –ø–æ—Ä—Ç–∞...</p>';
            }
            
            for (const port of ports) {
                try {
                    const testUrl = `http://localhost:${port}/Home/Index`;
                    const response = await fetch(testUrl, { 
                        method: 'GET', 
                        cache: 'no-cache',
                        signal: AbortSignal.timeout(2000)
                    });
                    if (response.ok || response.status === 401 || response.status === 403) {
                        baseUrl = `http://localhost:${port}`;
                        if (statusDiv) {
                            statusDiv.innerHTML = `<p style="color: green;">‚úì –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞–π–¥–µ–Ω–æ –Ω–∞ –ø–æ—Ä—Ç—É ${port}</p>`;
                        }
                        document.getElementById('testUrl').value = `${baseUrl}/Home/Index`;
                        return true;
                    }
                } catch (e) {
                    // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –ø–æ–∏—Å–∫
                }
            }
            
            if (statusDiv) {
                statusDiv.innerHTML = '<p style="color: red;">‚úó –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–Ω–æ –∑–∞–ø—É—â–µ–Ω–æ.</p>';
            }
            return false;
        }

        function updateBaseUrl() {
            const input = document.getElementById('baseUrlInput');
            if (input && input.value) {
                baseUrl = input.value.replace(/\/$/, ''); // –£–±–∏—Ä–∞–µ–º trailing slash
                document.getElementById('testUrl').value = `${baseUrl}/Home/Index`;
                const statusDiv = document.getElementById('connectionStatus');
                if (statusDiv) {
                    statusDiv.innerHTML = `<p style="color: blue;">URL –æ–±–Ω–æ–≤–ª–µ–Ω: ${baseUrl}</p>`;
                }
            }
        }

        async function testRateLimit(count = 15) {
            const resultsDiv = document.getElementById('rateLimitResults');
            resultsDiv.innerHTML = '<p>–û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ ' + baseUrl + '...</p>';
            
            let successCount = 0;
            let blockedCount = 0;
            let errorCount = 0;

            for (let i = 1; i <= count; i++) {
                try {
                    const startTime = Date.now();
                    const response = await fetch(`${baseUrl}/Home/Index`, {
                        method: 'GET',
                        cache: 'no-cache',
                        mode: 'cors'
                    });
                    const endTime = Date.now();
                    const duration = endTime - startTime;

                    if (response.status === 429) {
                        blockedCount++;
                        resultsDiv.innerHTML += `<p class="warning">Request ${i}: 429 Too Many Requests (–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ) - ${duration}ms</p>`;
                    } else if (response.ok) {
                        successCount++;
                        resultsDiv.innerHTML += `<p class="success">Request ${i}: ${response.status} OK - ${duration}ms</p>`;
                    } else {
                        errorCount++;
                        resultsDiv.innerHTML += `<p class="error">Request ${i}: ${response.status} - ${duration}ms</p>`;
                    }
                } catch (error) {
                    errorCount++;
                    const errorMsg = error.message || 'Failed to fetch';
                    resultsDiv.innerHTML += `<p class="error">Request ${i}: –û—à–∏–±–∫–∞ - ${errorMsg}</p>`;
                    if (i === 1) {
                        resultsDiv.innerHTML += `<p style="color: red; font-weight: bold;">‚ö† –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ –Ω–∞ ${baseUrl}</p>`;
                    }
                }
                
                // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
                await new Promise(resolve => setTimeout(resolve, 100));
            }

            resultsDiv.innerHTML += `<hr><p><strong>–ò—Ç–æ–≥–∏:</strong></p>`;
            resultsDiv.innerHTML += `<p class="success">–£—Å–ø–µ—à–Ω–æ: ${successCount}</p>`;
            resultsDiv.innerHTML += `<p class="warning">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ (429): ${blockedCount}</p>`;
            resultsDiv.innerHTML += `<p class="error">–û—à–∏–±–∫–∏: ${errorCount}</p>`;
            
            if (blockedCount > 0) {
                resultsDiv.innerHTML += `<p class="success"><strong>‚úì Rate Limiting —Ä–∞–±–æ—Ç–∞–µ—Ç!</strong></p>`;
            } else {
                resultsDiv.innerHTML += `<p class="warning"><strong>‚ö† Rate Limiting –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª (–≤–æ–∑–º–æ–∂–Ω–æ, –ª–∏–º–∏—Ç—ã —Å–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–∏–µ)</strong></p>`;
            }
        }

        function testRateLimitAggressive() {
            testRateLimit(30);
        }

        async function testSecurityHeaders() {
            const testPath = document.getElementById('testUrl').value || '/Home/Index';
            const url = baseUrl + testPath;
            const resultsDiv = document.getElementById('headersResults');
            resultsDiv.innerHTML = '<p>–ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤...</p>';

            try {
                const response = await fetch(url, {
                    method: 'GET',
                    cache: 'no-cache'
                });

                const requiredHeaders = {
                    'X-Content-Type-Options': 'nosniff',
                    'X-Frame-Options': 'DENY',
                    'X-XSS-Protection': '1; mode=block',
                    'Referrer-Policy': 'strict-origin-when-cross-origin',
                    'Content-Security-Policy': '*'
                };

                let foundCount = 0;
                let totalCount = Object.keys(requiredHeaders).length;

                resultsDiv.innerHTML = '<div class="header-test">';
                
                for (const [headerName, expectedValue] of Object.entries(requiredHeaders)) {
                    const headerValue = response.headers.get(headerName);
                    const isPresent = headerValue !== null;
                    
                    if (isPresent) {
                        foundCount++;
                        const matches = expectedValue === '*' || headerValue === expectedValue;
                        resultsDiv.innerHTML += `
                            <div class="header-item ${matches ? '' : 'missing'}">
                                <strong>${headerName}:</strong> ${headerValue}
                                ${matches ? '‚úì' : '‚ö† (–Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)'}
                            </div>
                        `;
                    } else {
                        resultsDiv.innerHTML += `
                            <div class="header-item missing">
                                <strong>${headerName}:</strong> –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç ‚úó
                            </div>
                        `;
                    }
                }

                resultsDiv.innerHTML += '</div>';
                resultsDiv.innerHTML += `<hr><p><strong>–ù–∞–π–¥–µ–Ω–æ: ${foundCount} –∏–∑ ${totalCount} –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤</strong></p>`;
                
                if (foundCount === totalCount) {
                    resultsDiv.innerHTML += `<p class="success"><strong>‚úì –í—Å–µ security headers –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç!</strong></p>`;
                } else {
                    resultsDiv.innerHTML += `<p class="warning"><strong>‚ö† –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç</strong></p>`;
                }
            } catch (error) {
                resultsDiv.innerHTML += `<p class="error">–û—à–∏–±–∫–∞: ${error.message}</p>`;
                resultsDiv.innerHTML += `<p class="error">–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ –∏ –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É ${url}</p>`;
            }
        }

        async function testSqlInjection() {
            const email = document.getElementById('sqlTestEmail').value;
            const resultsDiv = document.getElementById('sqlResults');
            resultsDiv.innerHTML = '<p>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ SQL –∏–Ω—ä–µ–∫—Ü–∏–∏...</p>';

            try {
                const formData = new FormData();
                formData.append('email', email);

                const response = await fetch(`${baseUrl}/Account/ForgotPassword`, {
                    method: 'POST',
                    body: formData,
                    headers: {
                        'X-Requested-With': 'XMLHttpRequest'
                    }
                });

                const responseText = await response.text();

                if (response.ok) {
                    resultsDiv.innerHTML += `<p class="success">–ó–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ (${response.status})</p>`;
                    resultsDiv.innerHTML += `<p>–ï—Å–ª–∏ SQL –∏–Ω—ä–µ–∫—Ü–∏—è –±—ã–ª–∞ –±—ã –≤–æ–∑–º–æ–∂–Ω–∞, –≤—ã –±—ã —É–≤–∏–¥–µ–ª–∏ –æ—à–∏–±–∫—É SQL –∏–ª–∏ –ø–æ–ª—É—á–∏–ª–∏ –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º.</p>`;
                    resultsDiv.innerHTML += `<p class="success">‚úì –ó–∞—â–∏—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç - –∑–∞–ø—Ä–æ—Å –æ–±—Ä–∞–±–æ—Ç–∞–Ω –∫–∞–∫ –æ–±—ã—á–Ω–∞—è —Å—Ç—Ä–æ–∫–∞</p>`;
                } else {
                    resultsDiv.innerHTML += `<p class="warning">–û—Ç–≤–µ—Ç: ${response.status}</p>`;
                }

                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ SQL –æ—à–∏–±–æ–∫ –≤ –æ—Ç–≤–µ—Ç–µ
                if (responseText.includes('SQL') && responseText.includes('error')) {
                    resultsDiv.innerHTML += `<p class="error">‚ö† –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–∞—è SQL –æ—à–∏–±–∫–∞ –≤ –æ—Ç–≤–µ—Ç–µ!</p>`;
                } else {
                    resultsDiv.innerHTML += `<p class="success">‚úì SQL –æ—à–∏–±–æ–∫ –≤ –æ—Ç–≤–µ—Ç–µ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ</p>`;
                }
            } catch (error) {
                resultsDiv.innerHTML += `<p class="error">–û—à–∏–±–∫–∞: ${error.message}</p>`;
            }
        }

        function testXSS() {
            const resultsDiv = document.getElementById('xssResults');
            resultsDiv.innerHTML = '<p>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ XSS –∑–∞—â–∏—Ç—ã —á–µ—Ä–µ–∑ CSP...</p>';

            try {
                // –ü–æ–ø—ã—Ç–∫–∞ —Å–æ–∑–¥–∞—Ç—å –≤–Ω–µ—à–Ω–∏–π —Å–∫—Ä–∏–ø—Ç
                const script = document.createElement('script');
                script.src = 'https://evil.com/script.js';
                script.onerror = function() {
                    resultsDiv.innerHTML += `<p class="success">‚úì CSP –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –∑–∞–≥—Ä—É–∑–∫—É –≤–Ω–µ—à–Ω–µ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞</p>`;
                };
                script.onload = function() {
                    resultsDiv.innerHTML += `<p class="error">‚úó CSP –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –≤–Ω–µ—à–Ω–∏–π —Å–∫—Ä–∏–ø—Ç!</p>`;
                };
                document.head.appendChild(script);

                // –ü–æ–ø—ã—Ç–∫–∞ inline —Å–∫—Ä–∏–ø—Ç–∞
                try {
                    eval('console.log("XSS test")');
                    resultsDiv.innerHTML += `<p class="warning">‚ö† Inline —Å–∫—Ä–∏–ø—Ç—ã –º–æ–≥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ CSP)</p>`;
                } catch (e) {
                    resultsDiv.innerHTML += `<p class="success">‚úì Inline —Å–∫—Ä–∏–ø—Ç—ã –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã</p>`;
                }

                resultsDiv.innerHTML += `<p><strong>–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:</strong> –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –¥–ª—è –¥–µ—Ç–∞–ª–µ–π</p>`;
            } catch (error) {
                resultsDiv.innerHTML += `<p class="error">–û—à–∏–±–∫–∞: ${error.message}</p>`;
            }
        }

        function testClickjacking() {
            const resultsDiv = document.getElementById('clickjackingResults');
            resultsDiv.innerHTML = '<p>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞—â–∏—Ç—ã –æ—Ç Clickjacking...</p>';

            try {
                const iframe = document.createElement('iframe');
                iframe.src = `${baseUrl}/Account/Login`;
                iframe.style.width = '100%';
                iframe.style.height = '400px';
                iframe.style.border = '2px solid red';

                iframe.onload = function() {
                    try {
                        // –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É iframe
                        const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                        resultsDiv.innerHTML += `<p class="error">‚úó –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∑–∏–ª–∞—Å—å –≤ iframe! X-Frame-Options –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç.</p>`;
                    } catch (e) {
                        resultsDiv.innerHTML += `<p class="success">‚úì X-Frame-Options —Ä–∞–±–æ—Ç–∞–µ—Ç - –¥–æ—Å—Ç—É–ø –∫ iframe –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω</p>`;
                        resultsDiv.innerHTML += `<p>–û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞: ${e.message}</p>`;
                    }
                };

                iframe.onerror = function() {
                    resultsDiv.innerHTML += `<p class="success">‚úì –°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–∞—Å—å –≤ iframe</p>`;
                };

                resultsDiv.appendChild(iframe);
                resultsDiv.innerHTML += `<p>–ü–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ iframe...</p>`;
            } catch (error) {
                resultsDiv.innerHTML += `<p class="success">‚úì –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ iframe: ${error.message}</p>`;
                resultsDiv.innerHTML += `<p>–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ X-Frame-Options —Ä–∞–±–æ—Ç–∞–µ—Ç!</p>`;
            }
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', function() {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π URL
            document.getElementById('currentUrl').textContent = baseUrl;
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏
            setTimeout(() => {
                testSecurityHeaders();
            }, 500);
        });
    </script>
</body>
</html>

